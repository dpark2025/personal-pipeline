# CommonJS `require` Usage in ES Module

## Title
Source code using CommonJS `require.main` in ES module environment

## Priority
Critical

## Severity
High

## Status
Closed - Resolved

## Description
The source code at `src/index.ts:97` uses `require.main === module` which is a CommonJS pattern, but the project is configured as an ES module. This causes runtime errors when trying to run the TypeScript source directly.

## Steps to Reproduce
1. Run `npm run dev` or any script that runs TypeScript source directly
2. Run benchmark tests that try to start the server
3. Error occurs: `ReferenceError: require is not defined in ES module scope`

## Expected Behavior
- Source code should use ES module patterns
- Should use `import.meta.url` pattern instead of `require.main`
- TypeScript source should run without CommonJS errors

## Actual Behavior
- Code fails with `ReferenceError: require is not defined`
- Scripts that start the server directly from source fail
- Development workflow broken

## Technical Details
- Error location: `/Users/dpark/projects/github.com/pp/src/index.ts:97`
- Current code uses: `if (require.main === module)`
- Should use ES module equivalent: `if (import.meta.url === new URL(process.argv[1], 'file:').href)`

## Files Affected
- `src/index.ts:97` (main entry point check)
- Potentially other files with CommonJS patterns

## Impact
- Development server cannot start
- Benchmark and testing scripts fail
- Hot reload development workflow broken
- Direct TypeScript execution fails

## Assign to
Backend Lead (Cindy) - TypeScript and ES module expertise needed

## Resolution
**Resolved by**: Backend Lead (Cindy)  
**Date**: 2025-07-29  
**Fix Applied**: Converted CommonJS patterns to ES module equivalents and fixed import extensions

**Verification**:
- ✅ `npm run dev` starts successfully without CommonJS errors
- ✅ Direct TypeScript execution working correctly
- ✅ Development workflow restored with hot reload
- ✅ All ES module patterns implemented correctly

## Additional Context
This is a code pattern issue where CommonJS patterns need to be converted to ES module equivalents. The entry point detection logic needs to be updated to work with ES modules.