{
  "id": "disk_space_critical_002",
  "title": "Disk Space - CRITICAL Alert Response",
  "version": "1.9",
  "description": "Runbook for responding to critical severity disk space alerts on log-server systems",
  "triggers": [
    "disk_usage_critical",
    "filesystem_full",
    "disk_space_warning"
  ],
  "severity_mapping": {
    "critical": "critical",
    "high": "high",
    "medium": "medium",
    "low": "low"
  },
  "decision_tree": {
    "id": "disk_space_decision_tree",
    "name": "Disk Space Decision Tree",
    "description": "Decision logic for handling disk space alerts",
    "branches": [
      {
        "id": "immediate_action",
        "condition": "disk_space_metric > critical_threshold",
        "description": "Immediate action required for critical disk space",
        "action": "emergency_procedure",
        "next_step": "verify_resolution",
        "confidence": 0.95,
        "rollback_step": "escalate_immediate"
      },
      {
        "id": "standard_response",
        "condition": "disk_space_metric > warning_threshold",
        "description": "Standard response for disk space issues",
        "action": "standard_procedure",
        "next_step": "monitor_improvement",
        "confidence": 0.85,
        "rollback_step": "escalate_to_specialist"
      },
      {
        "id": "monitor_only",
        "condition": "disk_space_metric <= warning_threshold",
        "description": "Issue within acceptable range, monitor for trends",
        "action": "increase_monitoring",
        "next_step": "scheduled_review",
        "confidence": 0.75
      }
    ],
    "default_action": "escalate_to_oncall"
  },
  "procedures": [
    {
      "id": "emergency_procedure",
      "name": "Emergency Disk Space Resolution",
      "description": "Immediate actions to resolve critical disk space on log-server",
      "command": "find /tmp -type f -atime +1 -delete && find /var/log -name '*.log' -size +100M -exec truncate -s 50M {} \\;",
      "expected_outcome": "Restore log-server to operational state within 5 minutes",
      "timeout_seconds": 300,
      "prerequisites": [
        "admin_access",
        "maintenance_window_optional"
      ],
      "rollback_procedure": "escalate_immediate",
      "tools_required": [
        "df",
        "du",
        "find"
      ]
    },
    {
      "id": "standard_procedure",
      "name": "Standard Disk Space Resolution",
      "description": "Standard resolution steps for disk space issues",
      "command": "du -sh /var/* | sort -hr | head -10 && find /tmp -type f -atime +7 -delete",
      "expected_outcome": "Resolve disk space issue within normal timeframe",
      "timeout_seconds": 1800,
      "prerequisites": [
        "standard_access"
      ],
      "rollback_procedure": "revert_changes",
      "tools_required": [
        "df",
        "du",
        "find",
        "ncdu"
      ]
    },
    {
      "id": "diagnostic_procedure",
      "name": "Disk Space Diagnostics",
      "description": "Gather diagnostic information for disk space analysis",
      "command": "df -h && du -sh /var/log/* /tmp/* | sort -hr",
      "expected_outcome": "Collect comprehensive diagnostic data",
      "timeout_seconds": 600,
      "prerequisites": [
        "read_access"
      ],
      "tools_required": [
        "df",
        "du",
        "find",
        "ncdu",
        "lsblk"
      ]
    }
  ],
  "escalation_path": "security",
  "metadata": {
    "created_at": "2025-07-28T23:59:26.363Z",
    "updated_at": "2025-07-28T23:59:26.363Z",
    "author": "SRE Team",
    "confidence_score": 0.7397290700254228,
    "success_rate": 0.9527304900753946,
    "avg_resolution_time_minutes": 120
  }
}